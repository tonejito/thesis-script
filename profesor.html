<html>
<!--
	= ^ . ^ =
-->
 <head>
  <meta charset="utf-8">
  <title>JSON</title>
  <link rel="stylesheet" href="/jqwidgets/styles/jqx.base.css" type="text/css" />
  <script type="text/javascript" src="/scripts/jquery-1.10.2.min.js"></script>
  <script type="text/javascript" src="/scripts/demos.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxcore.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxdata.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxbuttons.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxscrollbar.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxpanel.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxtree.js"></script>
  <script type="text/javascript" src="/jqwidgets/jqxexpander.js"></script>
  <script type="text/javascript">
(
 function()
 {
  $("html").append('\n<!--\n\t= ^ . ^ =\t\n-->\n');
 }
)();

//	http://api.jquery.com/jQuery.getJSON/
(
 function()
 {
  // Receive JSON payload
  var target = "/data.json";
  // Iterate on each parsed JSON element
  $.getJSON(target).done
  (
   function(data)
   {
    // Format JSON data
    var source =
    {
     datatype: "json",
     id:       'id',
     localdata: data,
     datafields:
     [
      { name:  'id'     },
      { name:  'parent' },
      { name:  'name'   },
     ]
    };
    // Prepare datasource to receive JSON parsed data
    var dataAdapter = new $.jqx.dataAdapter(source);
    dataAdapter.dataBind();
    var records = dataAdapter.getRecordsHierarchy
    (
     'id',
     'parent',
     'items',
     [
      {
       name: 'name',
       map:  'label'
      }
     ]
    );
    // Set widget display and control options
    $('#jqxExpander').jqxExpander
    (
     {
      showArrow:  false,
      toggleMode: 'none',
      width:      '50%',
      height:     '94%',
      expanded:   true
     }
    );
    $('#jqxTree').jqxTree
    (
     {
      source:             records,
      incrementalSearch:  false,
      keyboardNavigation: false,
      toggleMode:         'dblclick',
      width:              '99%',
      height:             '94%',
      theme:              'energyblue'
     }
    );

    // Prepare and display widgets
    $('#jqxExpander').jqxExpander('expand');
    $('#jqxTree').jqxTree('render');
    $('#jqxTree').jqxTree('expandAll');
    $('#jqxTree').jqxTree('selectItem',null);
    $('#jqxTree').jqxTree('focus');

    // Display a confirm dialog when the item is selected
    // if the confirmation dialog is accepted, send the user to the destination folder
    $('#jqxTree').on
    (
     'select',
     function (event)
     {
      var args = event.args;
      var item = $('#jqxTree').jqxTree('getItem', args.element);
      var label = item.label;
      var id = item.id;
      var path = "/"+id;
      // Print entire URL in the browser confirm dialog
      if(confirm(document.location.href.replace(window.location.pathname,path)))
       document.location.href = path;
     }
    );
   }
  );
 }
)();

/*
(
 function()
 {
  // Build items
  $("body").append
  ('
   <div id="links">
    <select id="type"></select>
    <select id="profesor"></select>
    <select id="subject"></select>
    <select id="year"></select>
    <select id="group"></select>
   </div>
  ');
  // Receive JSON payload
  var target = "/data.json";
  // Iterate on each parsed JSON element
  $.getJSON(target).done
  (
   function(data)
   {
    var items = [];
    $.each
    (
     data, function( k, p )
     {
      //items.push("<pre>"+key+"=>"+val+"</pre>"+"<hr/>");
      $('#type').append('<option id="' + p + '">' + k + '</option>');
      $.each
      (
       p, function(p1,m)
       {
        $('#profesor').append('<option id="' + m + '">' + p1 + '</option>');
        $.each
        (
         m, function(m1,y)
         {
          $('#subject').append('<option id="' + y + '">' + m1 + '</option>');
          $.each
          (
           y, function(y1,g)
           {
            y1 = y1.substring(1);
            $('#year').append('<option id="' + g + '">' + y1 + '</option>');
            $.each
            (
             g, function(g1,grp)
             {
              $('#group').append('<option id="' + grp + '">' + grp + '</option>');
              var path = "/"+k+"/"+p1+"/"+m1+"/"+y1+"/"+grp+"/";
              items.push("<a href='"+path+"'>"+path+"</a>"+"<br/>\n");
             }
            )
           }
          )
         }
        )
       }
      )
     }
    );
    $('#links').html(items.join(""));
   }
  );
 }
)();
*/
  </script>
 </head>
 <body>
   <div id='jqxExpander'>
    <div id='Header'></div>
    <div id='jqxTree'>
    </div>
   </div>
 </body>
</html>

